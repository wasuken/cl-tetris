(defpackage cl-tetris/tests/main
  (:use :cl
        :cl-tetris
        :rove))
(in-package :cl-tetris/tests/main)

;; NOTE: To run this test file, execute `(asdf:test-system :cl-tetris)' in your Lisp.

(defparameter *test-map* (cl-tetris:gen-map))

(deftest replace-map-test
	(testing "replace-map test pattern to succeed"
			 (ok (equal '((1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 0 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1))
						(cl-tetris:replace-map *test-map* 1 4 0))))
  (testing "replace-map test out of index(no change)"
		   (ok (equal '((1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1))
					  (cl-tetris:replace-map *test-map* 100 200 0)))
		   (ok (equal '((1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1)
						(1 1 1 1 1 1 1 1 1 1))
					  (cl-tetris:replace-map *test-map* 11 21 0))))
  )

(deftest put-block-test
	(testing "put-block test pattern to succeed"
			 (ok (equal '((1 1 1 1 0 1 1 1 1 1)
						  (1 1 1 1 0 0 1 1 1 1)
						  (1 1 1 1 0 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1)
						  (1 1 1 1 1 1 1 1 1 1))
						(cl-tetris:put-block *test-map*
											 '((1 1 1 1) (1 0 1 1) (1 0 0 1) (1 0 1 1)))))))
